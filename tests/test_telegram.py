"""
–¢–ï–°–¢ –¢–ï–õ–ï–ì–†–ê–ú –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
–ó–∞–ø—É—Å–∫: python test_telegram.py
"""
import sys
import os
sys.path.append('telegram')

try:
    from telegram_notifier import TelegramNotifier
    from config.telegram_config import TELEGRAM_TOKEN, TELEGRAM_CHAT_ID
    
    print("=" * 50)
    print("ü§ñ –¢–ï–°–¢ TELEGRAM –£–í–ï–î–û–ú–õ–ï–ù–ò–ô")
    print("=" * 50)
    
    # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    print(f"üîë –¢–æ–∫–µ–Ω: {TELEGRAM_TOKEN[:10]}...{TELEGRAM_TOKEN[-5:]}")
    print(f"üí¨ Chat ID: {TELEGRAM_CHAT_ID}")
    
    # 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    print("\n[1/3] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞...")
    notifier = TelegramNotifier(TELEGRAM_TOKEN, TELEGRAM_CHAT_ID)
    print("‚úÖ –ë–æ—Ç —Å–æ–∑–¥–∞–Ω")
    
    # 3. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    print("[2/3] –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è...")
    success = notifier.send_message(
        "üîî <b>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç Weeek Integration</b>\n"
        "‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç\n"
        f"üìÖ {os.path.basename(os.getcwd())}\n"
        "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n"
        "–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ,\n"
        "Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ!"
    )
    
    if success:
        print("‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ")
    
    # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫
    print("[3/3] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—à–∏–±–æ–∫...")
    notifier.send_error_alert("–¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã")
    print("‚úÖ –¢–µ—Å—Ç –æ—à–∏–±–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω")
    
    print("\n" + "=" * 50)
    print("üì± –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Telegram –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:")
    print("   1. –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
    print("   2. –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)")
    print("=" * 50)
    
except ImportError as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: {e}")
    print("\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:")
    print("1. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ telegram/telegram_notifier.py")
    print("2. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ config/telegram_config.py")
    print("3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏ –∏–º–ø–æ—Ä—Ç—ã –≤ telegram_notifier.py")
    
except Exception as e:
    print(f"‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")

input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")